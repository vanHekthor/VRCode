# Catena Test Vectors

This are test vectors for Catena implementations.

Every test vector is an array of tests
cases, each containing the inputs for the function in <color=#C3E88D>`inputs`</color> and the
expected outputs in <color=#C3E88D>`outputs`</color>.
Strings in these files have to be interpreted as hex encoded big endian byte
strings with two characters for a byte unless stated otherwise.

Each file uses up to one Catena instance for every contained test case, which is
specified in the file name. These instances are:

<color=#BB80B3>-</color> <color=#C3E88D>`Any`</color>:
Any Catena instance with H = Blake2b and H' = Blake2b-1
<color=#BB80B3>-</color> <color=#C3E88D>`Any Full`</color>:
Any Catena instance with H = H' = Blake2b
<color=#BB80B3>-</color> <color=#C3E88D>`Butterfly`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Butterfly Full`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Butterfly Reduced`</color>:
Catena Butterfly with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 9
<color=#BB80B3>-</color> <color=#C3E88D>`Butterfly Reduced Different G`</color>:
Catena Butterfly with <color=#C3E88D>`g_low`</color> = 8 and <color=#C3E88D>`g_high`</color> = 9
<color=#BB80B3>-</color> <color=#C3E88D>`Butterfly Full Reduced`</color>:
Catena Butterfly Full with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 9
<color=#BB80B3>-</color> <color=#C3E88D>`Dragonfly`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Dragonfly Full`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Dragonfly Reduced`</color>:
Dragonfly with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 14
<color=#BB80B3>-</color> <color=#C3E88D>`Dragonfly Full Reduced`</color>:
Dragonfly Full with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 14
<color=#BB80B3>-</color> <color=#C3E88D>`Stonefly`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Stonefly Full`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Stonefly Reduced`</color>:
Stonefly with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 9
<color=#BB80B3>-</color> <color=#C3E88D>`Stonefly Full Reduced`</color>:
Stonefly Full with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 9
<color=#BB80B3>-</color> <color=#C3E88D>`Mydasfly`</color>:
<color=#BB80B3>-</color> <color=#C3E88D>`Mydasfly Full`</color>:
<color=#BB80B3>-</color> <color=#C3E88D>`Mydasfly Reduced`</color>:
Mydasfly with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 9
<color=#BB80B3>-</color> <color=#C3E88D>`Mydasfly Full Reduced`</color>:
Mydasfly Full with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 9
<color=#BB80B3>-</color> <color=#C3E88D>`Lanternfly`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Lanternfly Full`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Lanternfly Reduced`</color>
Lanternfly with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 9
<color=#BB80B3>-</color> <color=#C3E88D>`Lanternfly Full Reduced`</color>:
Lanternfly Full with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 9
<color=#BB80B3>-</color> <color=#C3E88D>`Horsefly`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Horsefly Full`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`Horsefly Reduced`</color>:
Horsefly with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 13
<color=#BB80B3>-</color> <color=#C3E88D>`Horsefly Full Reduced`</color>:
Horsefly Full with <color=#C3E88D>`g_low`</color> = <color=#C3E88D>`g_high`</color> = 13

The purpose of the tests with the reduced Catena instances is to ensure that all
tests of all test vectors can run in acceptable time, even in the dynamically
typed languages.

Tests that do not need an instance of Catena have nothing appended to their
file names.

<color=#89DDFF>## Blake2b</color>
Test files:
<color=#BB80B3>-</color> <color=#C3E88D>`blake2b.json`</color>

<color=#89DDFF>## Blake2b-1</color>
Test files:
<color=#BB80B3>-</color>  <color=#C3E88D>`blake2b1.json`</color>

The tests are expected to run from first to last with the same instance of
Blake2b-1. The field <color=#C3E88D>`reset`</color> indicates wether or not the <color=#C3E88D>`reset`</color>
function of the Blake2b-1 instance has to be called before the test.

<color=#89DDFF>## CF_Argon2</color>
Test files for the complete compression function:
<color=#BB80B3>-</color>  <color=#C3E88D>`cfArgon2Gb.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`cfArgon2Gl.json`</color>

Test files for G<color=#89DDFF>_L and G_</color>B:
<color=#BB80B3>-</color>  <color=#C3E88D>`gB.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`gL.json`</color>

Test files for the $permute$ function:
<color=#BB80B3>-</color>  <color=#C3E88D>`permuteGb.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`permuteGl.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`permuteGbHex.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`permuteGlHex.json`</color>

The test files with the <color=#C3E88D>`Hex`</color> suffix are the test cases as the respective
files without the suffix. The hex versions have the 64 bit integers encoded as
hex values for the JavaScript implementation because JavaScript has no built-in
64 bit integer type.

<color=#89DDFF>## H_first</color>
Test files:
<color=#BB80B3>-</color>  <color=#C3E88D>`hFirstAny.json`</color>

<color=#89DDFF>## Bit-Reversal Graph</color>
Test files for index function:
<color=#BB80B3>-</color>  <color=#C3E88D>`brgIndex.json`</color>

Test files for full graph:
<color=#BB80B3>-</color>  <color=#C3E88D>`brgAny.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`brgAnyFull.json`</color>

<color=#89DDFF>## Shifted Bit-Reversal Graph</color>
Test files for index function:
<color=#BB80B3>-</color>  <color=#C3E88D>`sbrgIndex.json`</color>

Test files for full graph:
<color=#BB80B3>-</color>  <color=#C3E88D>`sbrgAny.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`sbrgAnyFull.json`</color>

<color=#89DDFF>## Gray-Reverse Graph</color>
Test files for index function:
<color=#BB80B3>-</color>  <color=#C3E88D>`grgIndex.json`</color>

Test files for full graph:
<color=#BB80B3>-</color>  <color=#C3E88D>`grgAny.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`grgAnyFull.json`</color>

<color=#89DDFF>## Double Butterfly Graph</color>
Test files for index function:
<color=#BB80B3>-</color>  <color=#C3E88D>`dbhIndex.json`</color>

Test files for full graph:
<color=#BB80B3>-</color>  <color=#C3E88D>`dbhAny.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`dbhAnyFull.json`</color>

<color=#89DDFF>## Saltmix</color>
Test files:
<color=#BB80B3>-</color>  <color=#C3E88D>`saltmix.json`</color>

The input <color=#C3E88D>`hash`</color> is the hashed salt, appended four times.

<color=#89DDFF>## Phi</color>
Test file for the LSB index function:
<color=#BB80B3>-</color> <color=#C3E88D>`lsbIndex.json`</color>

<color=#89DDFF>## H_init</color>
Test files:
<color=#BB80B3>-</color> <color=#C3E88D>`hInitAnyFull.json`</color>

The output tuple <color=#C3E88D>`v`</color> is <color=#C3E88D>`[v_-2, v_-1]`</color>.

<color=#89DDFF>## Tweak</color>
Test files:
<color=#BB80B3>-</color> <color=#C3E88D>`tweakButterfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`tweakButterflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`tweakDragonfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`tweakDragonflyFull.json`</color>

The field <color=#C3E88D>`aData`</color> is an UTF-8 string.

<color=#89DDFF>## Flap</color>
Test files:
<color=#BB80B3>-</color> <color=#C3E88D>`flapButterfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`flapButterflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`flapDragonfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`flapDragonflyFull.json`</color>

<color=#89DDFF>## Catena</color>
Test files:
<color=#BB80B3>-</color> <color=#C3E88D>`catenaButterfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaButterflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaButterflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaButterflyFullReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaDragonfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaDragonflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaDragonflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaDragonflyFullReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaHorsefly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaHorseflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaHorseflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaHorseflyFullReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaLanternfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaLanternflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaLanternflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaLanternflyFullReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaMydasfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaMydasflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaMydasflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaMydasflyFullReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaStonefly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaStoneflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaStoneflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`catenaStoneflyFullReduced.json`</color>

The non-reduced tests implicitly test the correct parameters of the default
instances and variants.

<color=#89DDFF>## Key Derivation</color>
Test files:
<color=#BB80B3>-</color> <color=#C3E88D>`keyDerivationButterfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyDerivationButterflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyDerivationButterflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyDerivationDragonfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyDerivationDragonflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyDerivationDragonflyReduced.json`</color>

<color=#89DDFF>## Keyed Hashing</color>
Test files:
<color=#BB80B3>-</color> <color=#C3E88D>`keyedHashButterfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyedHashButterflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyedHashButterflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyedHashDragonfly.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyedHashDragonflyFull.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`keyedHashDragonflyReduced.json`</color>

<color=#89DDFF>## Server Relief</color>
Test files for client side:
<color=#BB80B3>-</color> <color=#C3E88D>`serverReliefServerButterflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`serverReliefServerButterflyReducedDifferentG.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`serverReliefServerDragonflyReduced.json`</color>
The test case <color=#C3E88D>`serverReliefServerButterflyReducedDifferentG.json`</color> is
needed to test the loop in the server relief, which is skipped if <color=#C3E88D>`g_low`</color> =
<color=#C3E88D>`g_high`</color>.

Test files for server side:
<color=#BB80B3>-</color> <color=#C3E88D>`serverReliefServerButterflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`serverReliefServerDragonflyReduced.json`</color>

<color=#89DDFF>## Client-Independent Update</color>
Test files:
<color=#BB80B3>-</color> <color=#C3E88D>`ciUpdateDragonflyReduced.json`</color>

<color=#89DDFF>## Keyed Client-Independent Update</color>
Test files:
<color=#BB80B3>-</color> <color=#C3E88D>`ciUpdateKeyedDragonflyReduced.json`</color>

<color=#89DDFF>## Proof of Work</color>
Test files for the server side:
<color=#BB80B3>-</color> <color=#C3E88D>`proofOfWorkServerPwdButterflyReduced.json`</color>
<color=#BB80B3>-</color> <color=#C3E88D>`proofOfWorkServerSaltButterflyReduced.json`</color>

Test files for the client side:
<color=#BB80B3>-</color>  <color=#C3E88D>`proofOfWorkClientPwdButterflyReduced.json`</color>
<color=#BB80B3>-</color>  <color=#C3E88D>`proofOfWorkClientSaltButterflyReduced.json`</color>